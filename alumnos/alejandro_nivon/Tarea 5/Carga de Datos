-- CARGA DE TABLAS

-- FLIGHTS

CREATE DATABASE flights_tarea;

USE flights_tarea;

CREATE EXTERNAL TABLE IF NOT EXISTS flights(YEAR INT,MONTH INT,DAY INT,DAY_OF_WEEK INT,AIRLINE STRING,FLIGHT_NUMBER INT,TAIL_NUMBER STRING,ORIGIN_AIRPORT STRING,DESTINATION_AIRPORT STRING,SCHEDULED_DEPARTURE INT,DEPARTURE_TIME INT,DEPARTURE_DELAY INT,TAXI_OUT INT,WHEELS_OFF INT,SCHEDULED_TIME INT,ELAPSED_TIME INT,AIR_TIME INT,DISTANCE INT,WHEELS_ON INT,TAXI_IN INT,SCHEDULED_ARRIVAL INT,ARRIVAL_TIME INT,ARRIVAL_DELAY INT,DIVERTED INT,CANCELLED INT,CANCELLATION_REASON INT,AIR_SYSTEM_DELAY INT,SECURITY_DELAY INT,AIRLINE_DELAY INT,LATE_AIRCRAFT_DELAY INT,WEATHER_DELAY INT)
COMMENT 'Vuelos transaccional'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;

LOAD DATA LOCAL INPATH '/Volume/flights/flights.csv' INTO TABLE flights;


CREATE EXTERNAL TABLE IF NOT EXISTS airlines(IATA_CODE STRING,AIRLINE STRING)
COMMENT 'Líneas Aéreas'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;

LOAD DATA LOCAL INPATH '/Volume/flights/airlines.csv' INTO TABLE airlines;



CREATE EXTERNAL TABLE IF NOT EXISTS airports(IATA_CODE STRING,AIRPORT STRING,CITY STRING,STATE STRING,COUNTRY STRING,LATITUDE FLOAT,LONGITUDE FLOAT)
COMMENT 'Aeropuertos'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;

LOAD DATA LOCAL INPATH '/Volume/flights/airports.csv' INTO TABLE airports;

--NORTHWIND

CREATE DATABASE northwind_tarea;

USE northwind_tarea;

CREATE EXTERNAL TABLE IF NOT EXISTS customers(customerid STRING,companyname STRING,contactname STRING,contacttitle STRING,address STRING,city STRING,region STRING,postalcode STRING,country STRING,phone STRING,fax STRING)
COMMENT 'Clientes'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;

LOAD DATA LOCAL INPATH '/Volume/northwind/customers.csv' INTO TABLE customers;


CREATE EXTERNAL TABLE IF NOT EXISTS employees(employeeid STRING, lastname STRING, firstname STRING, title STRING, titleofcourtesy STRING, birthdate STRING, hiredate STRING, address STRING, city STRING, region STRING, postalcode STRING, country STRING, homephone STRING, extension STRING, photo STRING, notes STRING, reportsto STRING, photopath STRING)
COMMENT 'Empleados'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;

LOAD DATA LOCAL INPATH '/Volume/northwind/employees.csv' INTO TABLE employees;



CREATE EXTERNAL TABLE IF NOT EXISTS orderDetails(orderid INT, productid INT, unitprice INT, quantity INT, discount INT)
COMMENT 'Transaccional Ordenes'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;

LOAD DATA LOCAL INPATH '/Volume/northwind/order_details.csv' INTO TABLE orderDetails;



CREATE EXTERNAL TABLE IF NOT EXISTS orders(orderid INT, customerid STRING, employeeid INT, orderdate STRING, requireddate STRING, shippeddate STRING, shipvia INT, freight FLOAT, shipname STRING, shipaddress STRING, shipcity STRING, shipregion STRING, shippostalcode STRING, shipcountry STRING)
COMMENT 'Ordenes'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;

LOAD DATA LOCAL INPATH '/Volume/northwind/orders.csv' INTO TABLE orders;



CREATE EXTERNAL TABLE IF NOT EXISTS products(productid FLOAT, productname STRING, supplierid FLOAT, categoryid FLOAT, quantityperunit STRING, unitprice FLOAT, unitsinstock FLOAT, unitsonorder FLOAT, reorderlevel FLOAT, discontinued FLOAT)
COMMENT 'Productos'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;

LOAD DATA LOCAL INPATH '/Volume/northwind/products.csv' INTO TABLE products;
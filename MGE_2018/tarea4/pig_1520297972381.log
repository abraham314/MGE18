Pig Stack Trace
---------------
ERROR 1200: Pig script failed to parse: <line 6, column 50> Invalid scalar projection: airlines : A column needs to be projected from a relation for it to be used as a scalar

Failed to parse: Pig script failed to parse: <line 6, column 50> Invalid scalar projection: airlines : A column needs to be projected from a relation for it to be used as a scalar
	at org.apache.pig.parser.QueryParserDriver.parse(QueryParserDriver.java:199)
	at org.apache.pig.PigServer$Graph.validateQuery(PigServer.java:1792)
	at org.apache.pig.PigServer$Graph.registerQuery(PigServer.java:1765)
	at org.apache.pig.PigServer.registerQuery(PigServer.java:708)
	at org.apache.pig.tools.grunt.GruntParser.processPig(GruntParser.java:1110)
	at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:512)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:230)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:205)
	at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:66)
	at org.apache.pig.Main.run(Main.java:564)
	at org.apache.pig.Main.main(Main.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:221)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:136)
Caused by: <line 6, column 50> Invalid scalar projection: airlines : A column needs to be projected from a relation for it to be used as a scalar
	at org.apache.pig.parser.LogicalPlanGenerator.var_expr(LogicalPlanGenerator.java:10973)
	at org.apache.pig.parser.LogicalPlanGenerator.expr(LogicalPlanGenerator.java:10190)
	at org.apache.pig.parser.LogicalPlanGenerator.flatten_generated_item(LogicalPlanGenerator.java:7519)
	at org.apache.pig.parser.LogicalPlanGenerator.generate_clause(LogicalPlanGenerator.java:17621)
	at org.apache.pig.parser.LogicalPlanGenerator.foreach_plan(LogicalPlanGenerator.java:16013)
	at org.apache.pig.parser.LogicalPlanGenerator.foreach_clause(LogicalPlanGenerator.java:15880)
	at org.apache.pig.parser.LogicalPlanGenerator.op_clause(LogicalPlanGenerator.java:1933)
	at org.apache.pig.parser.LogicalPlanGenerator.general_statement(LogicalPlanGenerator.java:1102)
	at org.apache.pig.parser.LogicalPlanGenerator.statement(LogicalPlanGenerator.java:560)
	at org.apache.pig.parser.LogicalPlanGenerator.query(LogicalPlanGenerator.java:421)
	at org.apache.pig.parser.QueryParserDriver.parse(QueryParserDriver.java:191)
	... 16 more
================================================================================
Pig Stack Trace
---------------
ERROR 1025: <line 7, column 50> Invalid field projection. Projected field [airline] does not exist in schema: flights::year:float,flights::month:int,flights::day:int,flights::day_of_week:int,flights::airline:chararray,flights::flight_number:float,flights::tail_numer:chararray,flights::origin_airport:chararray,flights::destination_airport:chararray,flights::scheduled_departure:chararray,flights::departure_time:chararray,flights::departure_delay:int,flights::taxi_out:int,flights::wheels_off:chararray,flights::scheduled_time:float,flights::elapsed_time:float,flights::air_time:float,flights::distance:float,flights::wheels_on:chararray,flights::taxi_in:int,flights::scheduled_arrival:chararray,flights::arrival_time:chararray,flights::arrival_delay:int,flights::diverted:int,flights::cancelled:int,flights::cancelation_reason:chararray,flights::air_system_delay:chararray,flights::security_delay:chararray,flights::airline_delay:chararray,flights::late_aircraft_delay:chararray,flights::weather_delay:chararray,airlines::iata_code:chararray,airlines::airline:chararray.

org.apache.pig.impl.plan.PlanValidationException: ERROR 1025: <line 7, column 50> Invalid field projection. Projected field [airline] does not exist in schema: flights::year:float,flights::month:int,flights::day:int,flights::day_of_week:int,flights::airline:chararray,flights::flight_number:float,flights::tail_numer:chararray,flights::origin_airport:chararray,flights::destination_airport:chararray,flights::scheduled_departure:chararray,flights::departure_time:chararray,flights::departure_delay:int,flights::taxi_out:int,flights::wheels_off:chararray,flights::scheduled_time:float,flights::elapsed_time:float,flights::air_time:float,flights::distance:float,flights::wheels_on:chararray,flights::taxi_in:int,flights::scheduled_arrival:chararray,flights::arrival_time:chararray,flights::arrival_delay:int,flights::diverted:int,flights::cancelled:int,flights::cancelation_reason:chararray,flights::air_system_delay:chararray,flights::security_delay:chararray,flights::airline_delay:chararray,flights::late_aircraft_delay:chararray,flights::weather_delay:chararray,airlines::iata_code:chararray,airlines::airline:chararray.
	at org.apache.pig.newplan.logical.expression.ProjectExpression.findColNum(ProjectExpression.java:191)
	at org.apache.pig.newplan.logical.expression.ProjectExpression.setColumnNumberFromAlias(ProjectExpression.java:174)
	at org.apache.pig.newplan.logical.visitor.ColumnAliasConversionVisitor$1.visit(ColumnAliasConversionVisitor.java:53)
	at org.apache.pig.newplan.logical.expression.ProjectExpression.accept(ProjectExpression.java:215)
	at org.apache.pig.newplan.DependencyOrderWalker.walk(DependencyOrderWalker.java:75)
	at org.apache.pig.newplan.PlanVisitor.visit(PlanVisitor.java:52)
	at org.apache.pig.newplan.logical.optimizer.AllExpressionVisitor.visit(AllExpressionVisitor.java:142)
	at org.apache.pig.newplan.logical.relational.LOInnerLoad.accept(LOInnerLoad.java:128)
	at org.apache.pig.newplan.DependencyOrderWalker.walk(DependencyOrderWalker.java:75)
	at org.apache.pig.newplan.logical.optimizer.AllExpressionVisitor.visit(AllExpressionVisitor.java:124)
	at org.apache.pig.newplan.logical.relational.LOForEach.accept(LOForEach.java:87)
	at org.apache.pig.newplan.DependencyOrderWalker.walk(DependencyOrderWalker.java:75)
	at org.apache.pig.newplan.PlanVisitor.visit(PlanVisitor.java:52)
	at org.apache.pig.newplan.logical.relational.LogicalPlan.validate(LogicalPlan.java:176)
	at org.apache.pig.PigServer$Graph.validateQuery(PigServer.java:1793)
	at org.apache.pig.PigServer$Graph.registerQuery(PigServer.java:1765)
	at org.apache.pig.PigServer.registerQuery(PigServer.java:708)
	at org.apache.pig.tools.grunt.GruntParser.processPig(GruntParser.java:1110)
	at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:512)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:230)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:205)
	at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:66)
	at org.apache.pig.Main.run(Main.java:564)
	at org.apache.pig.Main.main(Main.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:221)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:136)
================================================================================
Pig Stack Trace
---------------
ERROR 1025: <line 16, column 29> Invalid field projection. Projected field [day_of_the_week] does not exist in schema: year:float,month:int,day:int,day_of_week:int,airline:chararray,flight_number:float,tail_numer:chararray,origin_airport:chararray,destination_airport:chararray,scheduled_departure:chararray,departure_time:chararray,departure_delay:int,taxi_out:int,wheels_off:chararray,scheduled_time:float,elapsed_time:float,air_time:float,distance:float,wheels_on:chararray,taxi_in:int,scheduled_arrival:chararray,arrival_time:chararray,arrival_delay:int,diverted:int,cancelled:int,cancelation_reason:chararray,air_system_delay:chararray,security_delay:chararray,airline_delay:chararray,late_aircraft_delay:chararray,weather_delay:chararray.

org.apache.pig.impl.plan.PlanValidationException: ERROR 1025: <line 16, column 29> Invalid field projection. Projected field [day_of_the_week] does not exist in schema: year:float,month:int,day:int,day_of_week:int,airline:chararray,flight_number:float,tail_numer:chararray,origin_airport:chararray,destination_airport:chararray,scheduled_departure:chararray,departure_time:chararray,departure_delay:int,taxi_out:int,wheels_off:chararray,scheduled_time:float,elapsed_time:float,air_time:float,distance:float,wheels_on:chararray,taxi_in:int,scheduled_arrival:chararray,arrival_time:chararray,arrival_delay:int,diverted:int,cancelled:int,cancelation_reason:chararray,air_system_delay:chararray,security_delay:chararray,airline_delay:chararray,late_aircraft_delay:chararray,weather_delay:chararray.
	at org.apache.pig.newplan.logical.expression.ProjectExpression.findColNum(ProjectExpression.java:191)
	at org.apache.pig.newplan.logical.expression.ProjectExpression.setColumnNumberFromAlias(ProjectExpression.java:174)
	at org.apache.pig.newplan.logical.visitor.ColumnAliasConversionVisitor$1.visit(ColumnAliasConversionVisitor.java:53)
	at org.apache.pig.newplan.logical.expression.ProjectExpression.accept(ProjectExpression.java:215)
	at org.apache.pig.newplan.DependencyOrderWalker.walk(DependencyOrderWalker.java:75)
	at org.apache.pig.newplan.PlanVisitor.visit(PlanVisitor.java:52)
	at org.apache.pig.newplan.logical.optimizer.AllExpressionVisitor.visitAll(AllExpressionVisitor.java:72)
	at org.apache.pig.newplan.logical.optimizer.AllExpressionVisitor.visit(AllExpressionVisitor.java:112)
	at org.apache.pig.newplan.logical.relational.LOCogroup.accept(LOCogroup.java:235)
	at org.apache.pig.newplan.DependencyOrderWalker.walk(DependencyOrderWalker.java:75)
	at org.apache.pig.newplan.PlanVisitor.visit(PlanVisitor.java:52)
	at org.apache.pig.newplan.logical.relational.LogicalPlan.validate(LogicalPlan.java:176)
	at org.apache.pig.PigServer$Graph.validateQuery(PigServer.java:1793)
	at org.apache.pig.PigServer$Graph.registerQuery(PigServer.java:1765)
	at org.apache.pig.PigServer.registerQuery(PigServer.java:708)
	at org.apache.pig.tools.grunt.GruntParser.processPig(GruntParser.java:1110)
	at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:512)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:230)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:205)
	at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:66)
	at org.apache.pig.Main.run(Main.java:564)
	at org.apache.pig.Main.main(Main.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:221)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:136)
================================================================================
Pig Stack Trace
---------------
ERROR 1200: Failed to create DataStorage

Failed to parse: Failed to create DataStorage
	at org.apache.pig.parser.QueryParserDriver.parse(QueryParserDriver.java:201)
	at org.apache.pig.PigServer$Graph.validateQuery(PigServer.java:1792)
	at org.apache.pig.PigServer$Graph.registerQuery(PigServer.java:1765)
	at org.apache.pig.PigServer.registerQuery(PigServer.java:708)
	at org.apache.pig.tools.grunt.GruntParser.processPig(GruntParser.java:1110)
	at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:512)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:230)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:205)
	at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:66)
	at org.apache.pig.Main.run(Main.java:564)
	at org.apache.pig.Main.main(Main.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:221)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:136)
Caused by: java.lang.RuntimeException: Failed to create DataStorage
	at org.apache.pig.backend.hadoop.datastorage.HDataStorage.init(HDataStorage.java:74)
	at org.apache.pig.backend.hadoop.datastorage.HDataStorage.<init>(HDataStorage.java:51)
	at org.apache.pig.builtin.JsonMetadata.findMetaFile(JsonMetadata.java:109)
	at org.apache.pig.builtin.JsonMetadata.getSchema(JsonMetadata.java:189)
	at org.apache.pig.builtin.PigStorage.getSchema(PigStorage.java:547)
	at org.apache.pig.newplan.logical.relational.LOLoad.getSchemaFromMetaData(LOLoad.java:175)
	at org.apache.pig.newplan.logical.relational.LOLoad.<init>(LOLoad.java:89)
	at org.apache.pig.parser.LogicalPlanBuilder.buildLoadOp(LogicalPlanBuilder.java:914)
	at org.apache.pig.parser.LogicalPlanGenerator.load_clause(LogicalPlanGenerator.java:3568)
	at org.apache.pig.parser.LogicalPlanGenerator.op_clause(LogicalPlanGenerator.java:1625)
	at org.apache.pig.parser.LogicalPlanGenerator.general_statement(LogicalPlanGenerator.java:1102)
	at org.apache.pig.parser.LogicalPlanGenerator.statement(LogicalPlanGenerator.java:560)
	at org.apache.pig.parser.LogicalPlanGenerator.query(LogicalPlanGenerator.java:421)
	at org.apache.pig.parser.QueryParserDriver.parse(QueryParserDriver.java:191)
	... 16 more
Caused by: java.io.IOException: No FileSystem for scheme: s3
	at org.apache.hadoop.fs.FileSystem.getFileSystemClass(FileSystem.java:2660)
	at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:2667)
	at org.apache.hadoop.fs.FileSystem.access$200(FileSystem.java:94)
	at org.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:2703)
	at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:2685)
	at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:373)
	at org.apache.pig.backend.hadoop.datastorage.HDataStorage.init(HDataStorage.java:69)
	... 29 more
================================================================================
Pig Stack Trace
---------------
ERROR 1200: org.apache.pig.newplan.logical.expression.ScalarExpression cannot be cast to org.apache.pig.newplan.logical.expression.ProjectExpression

Failed to parse: org.apache.pig.newplan.logical.expression.ScalarExpression cannot be cast to org.apache.pig.newplan.logical.expression.ProjectExpression
	at org.apache.pig.parser.QueryParserDriver.parse(QueryParserDriver.java:201)
	at org.apache.pig.PigServer$Graph.validateQuery(PigServer.java:1792)
	at org.apache.pig.PigServer$Graph.registerQuery(PigServer.java:1765)
	at org.apache.pig.PigServer.registerQuery(PigServer.java:708)
	at org.apache.pig.tools.grunt.GruntParser.processPig(GruntParser.java:1110)
	at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:512)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:230)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:205)
	at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:66)
	at org.apache.pig.Main.run(Main.java:564)
	at org.apache.pig.Main.main(Main.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:221)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:136)
Caused by: java.lang.ClassCastException: org.apache.pig.newplan.logical.expression.ScalarExpression cannot be cast to org.apache.pig.newplan.logical.expression.ProjectExpression
	at org.apache.pig.parser.LogicalPlanGenerator.nested_proj(LogicalPlanGenerator.java:16770)
	at org.apache.pig.parser.LogicalPlanGenerator.nested_op_input(LogicalPlanGenerator.java:17770)
	at org.apache.pig.parser.LogicalPlanGenerator.nested_distinct(LogicalPlanGenerator.java:17108)
	at org.apache.pig.parser.LogicalPlanGenerator.nested_op(LogicalPlanGenerator.java:16550)
	at org.apache.pig.parser.LogicalPlanGenerator.nested_command(LogicalPlanGenerator.java:16289)
	at org.apache.pig.parser.LogicalPlanGenerator.nested_blk(LogicalPlanGenerator.java:16147)
	at org.apache.pig.parser.LogicalPlanGenerator.foreach_plan(LogicalPlanGenerator.java:16055)
	at org.apache.pig.parser.LogicalPlanGenerator.foreach_clause(LogicalPlanGenerator.java:15880)
	at org.apache.pig.parser.LogicalPlanGenerator.op_clause(LogicalPlanGenerator.java:1933)
	at org.apache.pig.parser.LogicalPlanGenerator.general_statement(LogicalPlanGenerator.java:1102)
	at org.apache.pig.parser.LogicalPlanGenerator.statement(LogicalPlanGenerator.java:560)
	at org.apache.pig.parser.LogicalPlanGenerator.query(LogicalPlanGenerator.java:421)
	at org.apache.pig.parser.QueryParserDriver.parse(QueryParserDriver.java:191)
	... 16 more
================================================================================
Pig Stack Trace
---------------
ERROR 1025: <line 38, column 50> Invalid field projection. Projected field [flight_number] does not exist in schema: group:float,dest_cnt:long.

org.apache.pig.impl.plan.PlanValidationException: ERROR 1025: <line 38, column 50> Invalid field projection. Projected field [flight_number] does not exist in schema: group:float,dest_cnt:long.
	at org.apache.pig.newplan.logical.expression.ProjectExpression.findColNum(ProjectExpression.java:191)
	at org.apache.pig.newplan.logical.expression.ProjectExpression.setColumnNumberFromAlias(ProjectExpression.java:174)
	at org.apache.pig.newplan.logical.visitor.ColumnAliasConversionVisitor$1.visit(ColumnAliasConversionVisitor.java:53)
	at org.apache.pig.newplan.logical.expression.ProjectExpression.accept(ProjectExpression.java:215)
	at org.apache.pig.newplan.DependencyOrderWalker.walk(DependencyOrderWalker.java:75)
	at org.apache.pig.newplan.PlanVisitor.visit(PlanVisitor.java:52)
	at org.apache.pig.newplan.logical.optimizer.AllExpressionVisitor.visitAll(AllExpressionVisitor.java:72)
	at org.apache.pig.newplan.logical.optimizer.AllExpressionVisitor.visit(AllExpressionVisitor.java:95)
	at org.apache.pig.newplan.logical.relational.LOJoin.accept(LOJoin.java:173)
	at org.apache.pig.newplan.DependencyOrderWalker.walk(DependencyOrderWalker.java:75)
	at org.apache.pig.newplan.PlanVisitor.visit(PlanVisitor.java:52)
	at org.apache.pig.newplan.logical.relational.LogicalPlan.validate(LogicalPlan.java:176)
	at org.apache.pig.PigServer$Graph.validateQuery(PigServer.java:1793)
	at org.apache.pig.PigServer$Graph.registerQuery(PigServer.java:1765)
	at org.apache.pig.PigServer.registerQuery(PigServer.java:708)
	at org.apache.pig.tools.grunt.GruntParser.processPig(GruntParser.java:1110)
	at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:512)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:230)
	at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:205)
	at org.apache.pig.tools.grunt.Grunt.run(Grunt.java:66)
	at org.apache.pig.Main.run(Main.java:564)
	at org.apache.pig.Main.main(Main.java:175)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:221)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:136)
================================================================================
